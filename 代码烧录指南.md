# SmartOven 智能电烤箱控制器 - 代码烧录指南

## 📋 烧录前准备

### 1. 硬件连接检查
确保设备正确连接：
- ✅ ESP8266开发板（NodeMCU/Wemos D1 Mini）
- ✅ USB数据线连接到电脑
- ✅ 开发板电源指示灯亮起

### 2. 确定串口端口
设备连接后，在Windows设备管理器中查看串口端口：
- 打开"设备管理器" → "端口 (COM和LPT)"
- 查找类似 "USB-SERIAL CH340 (COMx)" 的设备
- 记录端口号（如 COM3、COM4、COM11等）

### 3. 软件环境准备

#### 方法A：使用Arduino IDE（推荐）
1. **下载安装Arduino IDE**
   - 访问 https://www.arduino.cc/en/software
   - 下载Windows版本并安装

2. **安装ESP8266开发板支持**
   - 打开Arduino IDE
   - 文件 → 首选项 → 附加开发板管理器网址
   - 添加：`http://arduino.esp8266.com/stable/package_esp8266com_index.json`
   - 工具 → 开发板 → 开发板管理器
   - 搜索 "esp8266" 并安装

3. **选择正确的开发板**
   - 工具 → 开发板 → NodeMCU 1.0 (ESP-12E Module)
   - 工具 → Flash Size → 4M (1M SPIFFS)
   - 工具 → CPU Frequency → 80 MHz
   - 工具 → Upload Speed → 115200

#### 方法B：使用PlatformIO（高级用户）
1. **安装VS Code + PlatformIO插件**
2. 打开项目文件夹
3. PlatformIO会自动识别 `platformio.ini` 配置

## 🔧 代码烧录步骤

### 步骤1：配置WiFi设置
修改 `SmartOvenController.ino` 中的WiFi配置：
```cpp
// 修改为您的实际WiFi信息
const char* sta_ssid = "您的WiFi名称";
const char* sta_password = "您的WiFi密码";
```

### 步骤2：选择烧录端口
在Arduino IDE中：
- 工具 → 端口 → 选择正确的COM端口
- 如果看不到端口，检查USB驱动安装

### 步骤3：编译代码
- 点击 "✓" 验证按钮编译代码
- 等待编译完成，检查是否有错误

### 步骤4：烧录到设备
- 点击 "→" 上传按钮开始烧录
- 观察进度条和状态信息
- 烧录成功后显示 "上传完成"

## 🔍 烧录故障排除

### 常见问题及解决方案

#### 1. 端口无法识别
**症状**: 设备管理器中看不到COM端口
**解决**:
- 重新插拔USB数据线
- 尝试不同的USB端口
- 安装CH340/CP2102驱动程序
- 重启电脑

#### 2. 上传失败 - 编程模式
**症状**: 上传时卡在"正在连接..."
**解决**:
- 确保开发板进入编程模式
- NodeMCU: 按住FLASH按钮，按一下RESET，松开FLASH
- 检查波特率设置为115200

#### 3. 编译错误 - 库缺失
**症状**: 编译时报库文件找不到
**解决**:
- 安装必要的库：
  - 工具 → 管理库 → 搜索安装：
    - ESP8266WiFi
    - ESP8266WebServer
    - MAX6675 by Adafruit

#### 4. 上传失败 - 权限问题
**症状**: 权限被拒绝错误
**解决**:
- 以管理员身份运行Arduino IDE
- 检查端口是否被其他程序占用

## 📊 烧录验证

### 1. 串口监视器验证
烧录完成后：
1. 打开Arduino IDE的串口监视器
2. 设置波特率：115200
3. 观察设备启动日志：
```
✅ SmartOven控制器启动成功
📡 WiFi连接中...
🌐 连接到WiFi: 您的WiFi名称
📊 设备IP地址: 192.168.1.100
🔍 设备发现服务已启动
```

### 2. Web界面验证
1. 在浏览器中输入设备显示的IP地址
2. 应该看到SmartOven控制界面
3. 测试基本功能：温度显示、按钮响应

### 3. 功能测试
- ✅ 温度传感器读数正常
- ✅ 继电器控制响应
- ✅ LED状态指示正确
- ✅ 蜂鸣器报警功能

## 🔄 批量烧录指南

### 多设备烧录流程
1. **准备烧录环境**
   - 安装Arduino IDE和必要库
   - 准备多根USB数据线

2. **顺序烧录**
   - 连接第一个设备 → 烧录 → 验证
   - 断开 → 连接第二个设备 → 重复

3. **设备标识设置**
   修改每个设备的唯一标识：
   ```cpp
   // 在代码中修改设备名称
   sprintf(deviceName, "SmartOven-%02d", deviceNumber);
   ```

## ⚠️ 安全注意事项

### 烧录安全
- 🔌 烧录时确保设备断电（除开发板USB供电）
- ⚡ 烧录完成后再连接高压部分
- 🔥 烧录过程中勿触摸电路板

### 操作安全
- 📋 烧录前备份原始代码
- 🔄 每次只烧录一个设备
- 📊 烧录后全面测试功能

## 📞 技术支持

### 获取帮助
如果遇到烧录问题：
1. **查看详细错误信息**
2. **检查硬件连接**
3. **参考故障排除章节**
4. **在GitHub提交Issue**

### 相关文档
- [电路连接图.md](电路连接图.md) - 硬件连接指南
- [安装指南.md](安装指南.md) - 完整安装步骤
- [故障排除指南.md](故障排除指南.md) - 问题解决方案

---

## 🎯 烧录成功标志

当您看到以下标志时，表示烧录成功：

1. **✅ Arduino IDE显示"上传完成"**
2. **✅ 串口监视器显示设备启动日志**
3. **✅ Web界面可以正常访问**
4. **✅ 基本功能测试通过**

**祝您烧录顺利！如有问题请参考本文档的故障排除章节。** 🛠️