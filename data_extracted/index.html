<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™ºèƒ½ç”µçƒ¤ç®± - ç®¡ç†å‘˜æ§åˆ¶é¢æ¿</title>
    <script>
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        window.addEventListener('load', function() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (!isLoggedIn) {
                // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
                window.location.href = 'login.html';
            }
        });
        
        // ç™»å‡ºåŠŸèƒ½
        function logout() {
            sessionStorage.removeItem('isLoggedIn');
            window.location.href = 'login.html';
        }
        
        // ä¿®æ”¹å¯†ç åŠŸèƒ½
        function changePassword() {
            const newPassword = prompt('è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘8ä½ï¼‰:');
            if (newPassword && newPassword.length >= 8) {
                localStorage.setItem('adminPassword', newPassword);
                alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼');
            } else if (newPassword) {
                alert('å¯†ç é•¿åº¦è‡³å°‘éœ€è¦8ä½ï¼');
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 20px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .title-section {
            flex: 1;
        }

        .main-title {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 8px;
            color: white;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.5px;
        }

        .title-icon {
            font-size: 48px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
            animation: pulse 2s ease-in-out infinite;
        }

        .title-badge {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            font-size: 14px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
        }

        .subtitle {
            font-size: 18px;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            letter-spacing: 0.5px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .status-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .status-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }

        .status-label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 24px;
            font-weight: 600;
        }

        .temperature {
            color: #ff6b6b;
        }

        .connected {
            color: #51cf66;
        }

        .control-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .quick-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .control-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        .control-btn.primary {
            background: #10b981;
            color: white;
        }

        .control-btn.secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .control-btn.tertiary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .admin-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .admin-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .admin-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .admin-btn {
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .admin-btn.wifi {
            background: #3b82f6;
            color: white;
        }

        .admin-btn.restart {
            background: #f59e0b;
            color: white;
        }

        .admin-btn.reset {
            background: #ef4444;
            color: white;
        }

        .admin-btn:active {
            transform: scale(0.95);
        }

        /* OTAå‡çº§æ ·å¼ */
        .ota-section {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
        }

        .ota-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .ota-current, .ota-status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
        }

        .ota-label {
            display: block;
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .ota-version, .ota-status-text {
            font-size: 14px;
            font-weight: 600;
        }

        .ota-upload {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }

        .ota-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
            justify-content: center;
        }

        .ota-btn {
            background: rgba(59, 130, 246, 0.8);
            color: white;
        }

        .ota-btn.upload {
            background: rgba(16, 185, 129, 0.8);
        }

        .ota-btn:disabled {
            background: rgba(107, 114, 128, 0.5);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .ota-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .ota-progress {
            margin-bottom: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            font-size: 12px;
            opacity: 0.8;
        }

        .ota-message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            font-size: 12px;
            text-align: center;
            min-height: 20px;
        }

        .ota-message.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
        }

        .ota-message.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
        }

        .ota-message.warning {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.5);
        }



        .api-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .api-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .api-endpoints {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .api-endpoint {
            margin-bottom: 8px;
            padding: 5px;
            border-left: 3px solid #10b981;
            background: rgba(16, 185, 129, 0.1);
        }



        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            font-size: 12px;
            opacity: 0.7;
        }

        .admin-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .logout-btn, .change-password-btn {
            padding: 12px 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .logout-btn:hover, .change-password-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }

        .logout-btn:active, .change-password-btn:active {
            transform: translateY(0);
        }

        .btn-icon {
            font-size: 16px;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
        }

        /* æ¸©åº¦æ§åˆ¶é¢æ¿æ ·å¼ */
        .temperature-display {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
        }

        .temp-display-item {
            text-align: center;
            flex: 1;
        }

        .temp-label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .current-temp, .target-temp {
            font-size: 32px;
            font-weight: 600;
        }

        .current-temp {
            color: #ff6b6b;
        }

        .target-temp {
            color: #3b82f6;
        }

        .temp-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .temp-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            min-width: 60px;
        }

        .temp-btn.large {
            min-width: 80px;
            background: rgba(255, 255, 255, 0.3);
        }

        .temp-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.4);
        }

        .temp-input-group {
            margin-bottom: 20px;
            text-align: center;
        }

        .temp-input-label {
            display: block;
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .temp-input {
            width: 200px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            text-align: center;
            margin-right: 10px;
        }

        .temp-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .temp-apply-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: #10b981;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .temp-apply-btn:active {
            transform: scale(0.95);
        }

        .temp-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .preset-btn {
            padding: 15px 10px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .preset-value {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .preset-label {
            font-size: 12px;
            opacity: 0.8;
        }

        .preset-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.25);
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .btn-primary {
            background: #10b981;
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .status-indicator {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .status-idle {
            background: rgba(107, 114, 128, 0.3);
            color: rgba(255, 255, 255, 0.8);
        }

        .status-heating {
            background: rgba(239, 68, 68, 0.3);
            color: #ff6b6b;
        }

        .status-cooling {
            background: rgba(59, 130, 246, 0.3);
            color: #3b82f6;
        }
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover, .change-password-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .logout-btn:active, .change-password-btn:active {
            transform: translateY(0);
        }

        @media (max-width: 480px) {
            .status-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-controls {
                flex-direction: column;
            }
            
            .control-btn {
                min-width: auto;
            }
        }

        /* Ã¦Â¸Â©Ã¥ÂºÂ¦Ã¦Â Â¡Ã¥Â‡Â†Ã¦Â Â·Ã¥Â¼Â */
        .calibration-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .calibration-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
        }

        .calibration-title {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
        }

        .calibration-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #fff;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calibration-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .calibration-content {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .calibration-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.4;
        }

        .calibration-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .calibration-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .calibration-label {
            font-size: 14px;
            color: #fff;
            min-width: 100px;
        }

        .calibration-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #fff;
            padding: 8px 12px;
            font-size: 14px;
            width: 120px;
        }

        .calibration-input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

        .calibration-apply-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: none;
            border-radius: 6px;
            color: white;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calibration-apply-btn:hover {
            background: linear-gradient(135deg, #45a049, #3d8b40);
            transform: translateY(-1px);
        }

        .calibration-presets {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .calibration-preset-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #fff;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 60px;
        }

        .calibration-preset-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .calibration-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }

        .calibration-status-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .calibration-status-value {
            font-size: 14px;
            font-weight: 600;
            color: #4CAF50;
        }

        @media (max-width: 480px) {
            .calibration-input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .calibration-label {
                min-width: auto;
            }
            
            .calibration-input {
                width: 100%;
            }
            
            .calibration-presets {
                justify-content: center;
            }
            
            /* Ã¦Â¸Â©Ã¥ÂºÂ¦Ã¦ÂÂ§Ã¥ÂˆÂ¶Ã©ÂÂ¢Ã¦ÂÂ¿Ã¥Â“ÂÃ¥ÂºÂ”Ã¥Â¼ÂÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .temperature-display {
                flex-direction: column;
                gap: 10px;
            }
            
            .temp-display-item {
                text-align: center;
            }
            
            .temp-controls {
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }
            
            .temp-btn {
                min-width: 60px;
                font-size: 14px;
                padding: 8px 12px;
            }
            
            .temp-btn.large {
                min-width: 70px;
            }
            
            .temp-input-group {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .temp-input-label {
                text-align: center;
            }
            
            .temp-input {
                width: 100%;
                text-align: center;
            }
            
            .temp-apply-btn {
                width: 100%;
            }
            
            .temp-presets {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .preset-btn {
                min-height: 60px;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .status-indicator {
                font-size: 12px;
                padding: 8px 12px;
            }
            
            /* Ã§Â®Â¡Ã§ÂÂ†Ã¥ÂŠÂŸÃ¨ÂƒÂ½Ã¥Â“ÂÃ¥ÂºÂ”Ã¥Â¼ÂÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .admin-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .admin-btn {
                width: 100%;
                justify-content: center;
            }
            
            /* OTAÃ¥ÂŠÂŸÃ¨ÂƒÂ½Ã¥Â“ÂÃ¥ÂºÂ”Ã¥Â¼ÂÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .ota-upload {
                flex-direction: column;
                gap: 10px;
            }
            
            .ota-btn {
                width: 100%;
                justify-content: center;
            }
            
            /* APIÃ§Â«Â¯Ã§Â‚Â¹Ã¥Â“ÂÃ¥ÂºÂ”Ã¥Â¼ÂÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .api-section {
                padding: 15px;
            }
            
            .api-endpoints {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .api-endpoint {
                padding: 12px;
            }
            
            .endpoint-method {
                min-width: 60px;
                font-size: 12px;
            }
            
            .endpoint-path {
                font-size: 12px;
            }
            
            /* Ã¥ÂŠÂŸÃ¨ÂƒÂ½Ã§Â½Â‘Ã¦Â Â¼Ã¥Â“ÂÃ¥ÂºÂ”Ã¥Â¼ÂÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .feature-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .feature-card {
                padding: 15px;
            }
            
            .feature-icon {
                font-size: 24px;
            }
            
            .feature-title {
                font-size: 16px;
            }
            
            .feature-description {
                font-size: 12px;
            }
        }
        
        @media (max-width: 768px) and (min-width: 481px) {
            /* Ã¥Â¹Â³Ã¦ÂÂ¿Ã§Â”ÂµÃ¨Â„Â‘Ã¥Â’ÂŒÃ¥Â¤Â§Ã¥Â±ÂÃ¥Â¹Â•Ã¦Â‰Â‹Ã¦ÂœÂºÃ¤Â¼Â˜Ã¥ÂŒÂ– */
            .temp-presets {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .feature-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .api-endpoints {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* ç³»ç»Ÿç®¡ç†æ ·å¼ */
        .system-management {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
            color: white;
        }
        
        .management-grid {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .management-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .management-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .management-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .management-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: white;
        }
        
        .management-description {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.4;
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* ç³»ç»Ÿç®¡ç†å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 768px) {
            .management-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .management-grid {
                grid-template-columns: 1fr;
            }
            
            .management-card {
                padding: 15px;
            }
            
            .management-icon {
                font-size: 28px;
            }
            
            .management-title {
                font-size: 14px;
            }
            
            .management-description {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="title-section">
                    <h1 class="main-title">
                        <span class="title-icon">ğŸ”¥</span>
                        æ™ºèƒ½ç”µçƒ¤ç®±
                        <span class="title-badge">PRO</span>
                    </h1>
                    <p class="subtitle">æ™ºèƒ½æ¸©åº¦æ§åˆ¶ç³»ç»Ÿ Â· ç®¡ç†å‘˜æ§åˆ¶é¢æ¿</p>
                </div>
                <div class="admin-controls">
                    <button class="logout-btn" onclick="logout()">
                        <span class="btn-icon">ğŸšª</span>
                        é€€å‡º
                    </button>
                    <button class="change-password-btn" onclick="changePassword()">
                        <span class="btn-icon">ğŸ”’</span>
                        ä¿®æ”¹å¯†ç 
                    </button>
                </div>
            </div>
        </div>

        <!-- è®¾å¤‡çŠ¶æ€ -->
        <div class="status-card">
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">åŠ çƒ­çŠ¶æ€</div>
                    <div class="status-value">--</div>
                </div>
                <div class="status-item">
                    <div class="status-label">WiFiçŠ¶æ€</div>
                    <div class="status-value connected">--</div>
                </div>
            </div>
        </div>

        <!-- æ¸©åº¦æ§åˆ¶é¢æ¿ -->
        <div class="control-section">
            <div class="temperature-display">
                <div class="temp-display-item">
                    <div class="temp-label">å½“å‰æ¸©åº¦</div>
                    <div class="current-temp" id="current-temp-display">--Â°C</div>
                </div>
                <div class="temp-display-item">
                    <div class="temp-label">ç›®æ ‡æ¸©åº¦</div>
                    <div class="target-temp" id="target-temp-display">--Â°C</div>
                </div>
            </div>

            <!-- æ¸©åº¦è°ƒèŠ‚æŒ‰é’® -->
            <div class="temp-controls">
                <button class="temp-btn large" onclick="changeTemp(-5)">-5Â°</button>
                <button class="temp-btn" onclick="changeTemp(-1)">-1Â°</button>
                <button class="temp-btn" onclick="changeTemp(1)">+1Â°</button>
                <button class="temp-btn large" onclick="changeTemp(5)">+5Â°</button>
            </div>

            <!-- æ¸©åº¦è¾“å…¥æ¡† -->
            <div class="temp-input-group">
                <label class="temp-input-label">ç›´æ¥è®¾ç½®æ¸©åº¦ (Â°C)</label>
                <input type="number" class="temp-input" id="temp-input" 
                       placeholder="è¾“å…¥ç›®æ ‡æ¸©åº¦" min="0" max="300" step="1">
                <button class="temp-apply-btn" onclick="applyTemperature()">åº”ç”¨</button>
            </div>

            <!-- æ¸©åº¦é¢„è®¾æŒ‰é’® -->
            <div class="temp-presets">
                <button class="preset-btn" onclick="setPresetTemp(50)">
                    <div class="preset-value">50Â°C</div>
                    <div class="preset-label">ä½æ¸©</div>
                </button>
                <button class="preset-btn" onclick="setPresetTemp(100)">
                    <div class="preset-value">100Â°C</div>
                    <div class="preset-label">ä¸­æ¸©</div>
                </button>
                <button class="preset-btn" onclick="setPresetTemp(150)">
                    <div class="preset-value">150Â°C</div>
                    <div class="preset-label">ä¸­é«˜æ¸©</div>
                </button>
                <button class="preset-btn" onclick="setPresetTemp(200)">
                    <div class="preset-value">200Â°C</div>
                    <div class="preset-label">é«˜æ¸©</div>
                </button>
                <button class="preset-btn" onclick="setPresetTemp(250)">
                    <div class="preset-value">250Â°C</div>
                    <div class="preset-label">è¶…é«˜æ¸©</div>
                </button>
                <button class="preset-btn" onclick="setPresetTemp(0)">
                    <div class="preset-value">0Â°C</div>
                    <div class="preset-label">å…³é—­</div>
                </button>
            </div>

            <!-- åŠ çƒ­æ§åˆ¶æŒ‰é’® -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="toggleHeating()" id="heating-btn">
                    å¼€å¯åŠ çƒ­
                </button>
                <button class="btn btn-secondary" onclick="refreshData()">
                    åˆ·æ–°çŠ¶æ€
                </button>
            </div>

            <!-- åŠ çƒ­çŠ¶æ€æŒ‡ç¤ºå™¨ -->
            <div class="status-indicator status-idle" id="heating-status">
                åŠ çƒ­å™¨å·²å…³é—­
            </div>

            <!-- æ¸©åº¦æ ¡å‡†åŠŸèƒ½ -->
            <div class="calibration-section">
                <div class="calibration-header">
                    <span class="calibration-title">æ¸©åº¦æ ¡å‡†</span>
                    <button class="calibration-toggle" onclick="toggleCalibration()" id="calibration-toggle">
                        å±•å¼€
                    </button>
                </div>
                <div class="calibration-content" id="calibration-content" style="display: none;">
                    <div class="calibration-info">
                        <p>æ¸©åº¦æ ¡å‡†å¯ä»¥è°ƒæ•´æ¸©åº¦ä¼ æ„Ÿå™¨çš„å‡å°è¯¯å·®ï¼Œæé«˜æ¸©åº¦æµ‹é‡ç²¾åº¦</p>
                    </div>
                    <div class="calibration-controls">
                        <div class="calibration-input-group">
                            <label class="calibration-label">æ ¡å‡†å€¼ (Â°C)</label>
                            <input type="number" class="calibration-input" id="calibration-input" 
                                   placeholder="è¾“å…¥æ ¡å‡†å€¼" min="-10" max="10" step="0.1">
                            <button class="calibration-apply-btn" onclick="applyCalibration()">åº”ç”¨æ ¡å‡†</button>
                        </div>
                        <div class="calibration-presets">
                            <button class="calibration-preset-btn" onclick="setCalibration(-1)">-1Â°C</button>
                            <button class="calibration-preset-btn" onclick="setCalibration(-0.5)">-0.5Â°C</button>
                            <button class="calibration-preset-btn" onclick="setCalibration(0)">0Â°C</button>
                            <button class="calibration-preset-btn" onclick="setCalibration(0.5)">+0.5Â°C</button>
                            <button class="calibration-preset-btn" onclick="setCalibration(1)">+1Â°C</button>
                        </div>
                    </div>
                    <div class="calibration-status">
                        <span class="calibration-status-label">å½“å‰æ ¡å‡†å€¼:</span>
                        <span class="calibration-status-value" id="current-calibration">0.0Â°C</span>
                    </div>
                </div>
            </div>
        </div>



        <!-- ç³»ç»Ÿç®¡ç† -->
        <div class="system-management">
            <div class="section-title">ç³»ç»Ÿç®¡ç†</div>
            <div class="management-grid">
                <div class="management-card" onclick="openWifiConfig()">
                    <div class="management-icon">ğŸ“¶</div>
                    <div class="management-title">WiFié…ç½®</div>
                    <div class="management-description">é…ç½®è®¾å¤‡WiFiç½‘ç»œè¿æ¥ï¼Œä¿®æ”¹SSIDå’Œå¯†ç </div>
                </div>
                <div class="management-card" onclick="restartDevice()">
                    <div class="management-icon">ğŸ”„</div>
                    <div class="management-title">é‡å¯è®¾å¤‡</div>
                    <div class="management-description">é‡å¯æ™ºèƒ½ç”µçƒ¤ç®±è®¾å¤‡ï¼Œåº”ç”¨æ–°çš„è®¾ç½®</div>
                </div>
                <div class="management-card" onclick="factoryReset()">
                    <div class="management-icon">âš ï¸</div>
                    <div class="management-title">æ¢å¤å‡ºå‚è®¾ç½®</div>
                    <div class="management-description">æ¸…é™¤æ‰€æœ‰è®¾ç½®ï¼Œæ¢å¤è®¾å¤‡åˆ°å‡ºå‚çŠ¶æ€</div>
                </div>
            </div>
        </div>

        <!-- OTAå›ºä»¶å‡çº§ -->
        <div class="admin-section">
            <div class="admin-title">å›ºä»¶å‡çº§ (OTA)</div>
            <div class="ota-section">
                <div class="ota-info">
                    <div class="ota-current">
                        <span class="ota-label">å½“å‰å›ºä»¶ç‰ˆæœ¬:</span>
                        <span class="ota-version" id="current-firmware">--</span>
                    </div>
                    <div class="ota-status">
                        <span class="ota-label">å‡çº§çŠ¶æ€:</span>
                        <span class="ota-status-text" id="ota-status">å°±ç»ª</span>
                    </div>
                </div>
                
                <div class="ota-upload">
                    <input type="file" id="firmware-file" accept=".bin,.hex,.ino" style="display: none;">
                    <button class="ota-btn" onclick="document.getElementById('firmware-file').click()">
                        <span>ğŸ“</span>
                        <span>é€‰æ‹©å›ºä»¶æ–‡ä»¶</span>
                    </button>
                    <button class="ota-btn upload" id="upload-btn" onclick="uploadFirmware()" disabled>
                        <span>â¬†ï¸</span>
                        <span>å¼€å§‹å‡çº§</span>
                    </button>
                </div>
                
                <div class="ota-progress" id="ota-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">0%</div>
                </div>
                
                <div class="ota-message" id="ota-message"></div>
            </div>
        </div>

        <!-- APIç«¯ç‚¹ä¿¡æ¯ -->
        <div class="api-section">
            <div class="api-title">APIç«¯ç‚¹</div>
            <div class="api-endpoints">
                <div class="api-endpoint">GET /status - è·å–è®¾å¤‡çŠ¶æ€</div>
                <div class="api-endpoint">POST /control - æ§åˆ¶åŠ çƒ­å™¨</div>
                <div class="api-endpoint">POST /wificonfig - é…ç½®WiFi</div>
                <div class="api-endpoint">POST /restart - é‡å¯è®¾å¤‡</div>
                <div class="api-endpoint">POST /factoryreset - æ¢å¤å‡ºå‚è®¾ç½®</div>
                <div class="api-endpoint">POST /ota_update - OTAå›ºä»¶å‡çº§</div>
            </div>
        </div>

        <div class="footer">
            <p>æ™ºèƒ½ç”µçƒ¤ç®±æ§åˆ¶å™¨ v0.6.6</p>
            <p>Â© 2025 æ™ºèƒ½ç”µçƒ¤ç®±é¡¹ç›®</p>
        </div>
    </div>
            <script>
        // è®¾å¤‡çŠ¶æ€å˜é‡
        let deviceStatus = {
            currentTemp: 0,
            targetTemp: 180,
            heatingEnabled: false,
            wifiConnected: false,
            wifiSSID: '',
            ipAddress: '',
            deviceId: '',
            firmwareVersion: ''
        };

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('æ™ºèƒ½ç”µçƒ¤ç®±ç®¡ç†å‘˜é¡µé¢å·²åŠ è½½');
            refreshData();
            
            // æ¯5ç§’è‡ªåŠ¨åˆ·æ–°æ•°æ®
            setInterval(refreshData, 5000);
            
            // åˆå§‹åŒ–æ–‡ä»¶é€‰æ‹©äº‹ä»¶
            const firmwareFileInput = document.getElementById('firmware-file');
            if (firmwareFileInput) {
                firmwareFileInput.addEventListener('change', handleFileSelect);
            }
        });

        // åˆ·æ–°è®¾å¤‡æ•°æ®
        async function refreshData() {
            try {
                const response = await fetch('/status');
                if (response.ok) {
                    const data = await response.json();
                    updateStatusDisplay(data);
                } else {
                    console.error('è·å–è®¾å¤‡çŠ¶æ€å¤±è´¥');
                    showDemoData();
                }
            } catch (error) {
                console.error('ç½‘ç»œè¿æ¥å¤±è´¥:', error);
                showDemoData();
            }
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatusDisplay(data) {
            deviceStatus = {
                currentTemp: data.temperature || 0,
                targetTemp: data.target_temperature || 180,
                heatingEnabled: data.heating_enabled || false,
                wifiConnected: data.wifi_connected || false,
                wifiSSID: data.wifiSSID || '',
                ipAddress: data.ip_address || '',
                deviceId: data.device_id || '',
                firmwareVersion: data.firmware_version || ''
            };

            // å®‰å…¨åœ°æ›´æ–°æ¸©åº¦æ˜¾ç¤º
            const statusItems = document.querySelectorAll('.status-item');
            if (statusItems.length >= 4) {
                statusItems[0].querySelector('.status-value').textContent = 
                    deviceStatus.currentTemp.toFixed(1) + 'Â°C';
                statusItems[1].querySelector('.status-value').textContent = 
                    deviceStatus.targetTemp.toFixed(1) + 'Â°C';
                
                // æ›´æ–°åŠ çƒ­çŠ¶æ€
                const heatingStatus = deviceStatus.heatingEnabled ? 'åŠ çƒ­ä¸­' : 'å·²åœæ­¢';
                statusItems[2].querySelector('.status-value').textContent = heatingStatus;
                statusItems[2].querySelector('.status-value').style.color = 
                    deviceStatus.heatingEnabled ? '#10b981' : '#6b7280';
                
                // æ›´æ–°WiFiçŠ¶æ€
                const wifiStatus = deviceStatus.wifiConnected ? 'å·²è¿æ¥' : 'æœªè¿æ¥';
                statusItems[3].querySelector('.status-value').textContent = wifiStatus;
                statusItems[3].querySelector('.status-value').style.color = 
                    deviceStatus.wifiConnected ? '#10b981' : '#ef4444';
            }
        }

        // æ˜¾ç¤ºæ¼”ç¤ºæ•°æ®ï¼ˆç½‘ç»œè¿æ¥å¤±è´¥æ—¶ï¼‰
        function showDemoData() {
            const demoData = {
                temperature: 25.5,
                target_temperature: 180,
                heating_enabled: false,
                wifi_connected: true,
                wifiSSID: 'SmartOven_AP',
                ip_address: '192.168.4.1',
                device_id: 'SmartOven_001',
                firmware_version: 'v1.0'
            };
            
            const connectionStatus = document.getElementById('connection-status');
            if (connectionStatus) {
                connectionStatus.textContent = 'æ¼”ç¤ºæ¨¡å¼';
                connectionStatus.style.color = '#f59e0b';
            }
            updateStatusDisplay(demoData);
        }

        // åˆ‡æ¢åŠ çƒ­çŠ¶æ€
        async function toggleHeating() {
            try {
                const response = await fetch('/control', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        heating_enabled: !deviceStatus.heatingEnabled
                    })
                });
                
                if (response.ok) {
                    refreshData();
                } else {
                    alert('æ§åˆ¶å‘½ä»¤å‘é€å¤±è´¥');
                }
            } catch (error) {
                console.error('æ§åˆ¶è®¾å¤‡å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥');
            }
        }

        // å¿«é€Ÿè®¾ç½®æ¸©åº¦
        async function quickSetTemp(temp) {
            try {
                const response = await fetch('/control', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        target_temperature: temp
                    })
                });
                
                if (response.ok) {
                    refreshData();
                } else {
                    alert('æ¸©åº¦è®¾ç½®å¤±è´¥');
                }
            } catch (error) {
                console.error('è®¾ç½®æ¸©åº¦å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥');
            }
        }

        // é‡å¯è®¾å¤‡
        async function restartDevice() {
            if (confirm('ç¡®å®šè¦é‡å¯è®¾å¤‡å—ï¼Ÿè®¾å¤‡å°†åœ¨5ç§’åé‡å¯ã€‚')) {
                try {
                    const response = await fetch('/restart', {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        alert('è®¾å¤‡é‡å¯å‘½ä»¤å·²å‘é€ï¼Œè¯·ç­‰å¾…çº¦30ç§’åé‡æ–°è¿æ¥');
                    } else {
                        alert('é‡å¯å‘½ä»¤å‘é€å¤±è´¥');
                    }
                } catch (error) {
                    console.error('é‡å¯è®¾å¤‡å¤±è´¥:', error);
                    alert('ç½‘ç»œè¿æ¥å¤±è´¥');
                }
            }
        }

        // æ¢å¤å‡ºå‚è®¾ç½®
        async function factoryReset() {
            if (confirm('ç¡®å®šè¦æ¢å¤å‡ºå‚è®¾ç½®å—ï¼Ÿæ‰€æœ‰é…ç½®å°†è¢«æ¸…é™¤ï¼Œè®¾å¤‡å°†é‡å¯ã€‚')) {
                try {
                    const response = await fetch('/factoryreset', {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        alert('æ¢å¤å‡ºå‚è®¾ç½®å‘½ä»¤å·²å‘é€ï¼Œè®¾å¤‡å°†é‡å¯å¹¶è¿›å…¥é…ç½‘æ¨¡å¼');
                    } else {
                        alert('æ¢å¤å‡ºå‚è®¾ç½®å‘½ä»¤å‘é€å¤±è´¥');
                    }
                } catch (error) {
                    console.error('æ¢å¤å‡ºå‚è®¾ç½®å¤±è´¥:', error);
                    alert('ç½‘ç»œè¿æ¥å¤±è´¥');
                }
            }
        }

        // OTAå›ºä»¶å‡çº§åŠŸèƒ½
        let selectedFirmwareFile = null;



        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                const allowedTypes = ['.bin', '.hex', '.ino'];
                const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                
                if (!allowedTypes.includes(fileExtension)) {
                    showOtaMessage('è¯·é€‰æ‹©æœ‰æ•ˆçš„å›ºä»¶æ–‡ä»¶ (.bin, .hex, .ino)', 'error');
                    resetFileInput();
                    return;
                }
                
                // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆæœ€å¤§10MBï¼‰
                if (file.size > 10 * 1024 * 1024) {
                    showOtaMessage('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB', 'error');
                    resetFileInput();
                    return;
                }
                
                selectedFirmwareFile = file;
                document.getElementById('upload-btn').disabled = false;
                showOtaMessage(`å·²é€‰æ‹©æ–‡ä»¶: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`, 'success');
                updateOtaStatus('æ–‡ä»¶å·²é€‰æ‹©ï¼Œå‡†å¤‡ä¸Šä¼ ');
            }
        }

        // é‡ç½®æ–‡ä»¶è¾“å…¥
        function resetFileInput() {
            const fileInput = document.getElementById('firmware-file');
            fileInput.value = '';
            selectedFirmwareFile = null;
            document.getElementById('upload-btn').disabled = true;
        }

        // ä¸Šä¼ å›ºä»¶æ–‡ä»¶
        async function uploadFirmware() {
            if (!selectedFirmwareFile) {
                showOtaMessage('è¯·å…ˆé€‰æ‹©å›ºä»¶æ–‡ä»¶', 'error');
                return;
            }
            
            if (!confirm('ç¡®å®šè¦ä¸Šä¼ å›ºä»¶å—ï¼Ÿè®¾å¤‡å°†åœ¨å‡çº§è¿‡ç¨‹ä¸­é‡å¯ï¼Œè¯·ç¡®ä¿è®¾å¤‡è¿æ¥ç¨³å®šã€‚')) {
                return;
            }
            
            try {
                updateOtaStatus('æ­£åœ¨ä¸Šä¼ å›ºä»¶...');
                showOtaMessage('å¼€å§‹ä¸Šä¼ å›ºä»¶æ–‡ä»¶ï¼Œè¯·å‹¿å…³é—­é¡µé¢', 'warning');
                
                // æ˜¾ç¤ºè¿›åº¦æ¡
                const progressContainer = document.getElementById('ota-progress');
                const progressFill = document.getElementById('progress-fill');
                const progressText = document.getElementById('progress-text');
                progressContainer.style.display = 'block';
                
                // åˆ›å»ºFormDataå¯¹è±¡
                const formData = new FormData();
                formData.append('firmware', selectedFirmwareFile);
                
                // å‘é€OTAå‡çº§è¯·æ±‚
                const response = await fetch('/ota_update', {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        showOtaMessage('å›ºä»¶å‡çº§æˆåŠŸï¼è®¾å¤‡æ­£åœ¨é‡å¯...', 'success');
                        updateOtaStatus('å‡çº§å®Œæˆ');
                        updateProgress(100);
                        
                        // ç­‰å¾…è®¾å¤‡é‡å¯
                        setTimeout(() => {
                            showOtaMessage('è®¾å¤‡é‡å¯å®Œæˆï¼Œè¯·é‡æ–°è¿æ¥', 'success');
                            refreshData();
                        }, 30000);
                    } else {
                        showOtaMessage(`å‡çº§å¤±è´¥: ${result.message}`, 'error');
                        updateOtaStatus('å‡çº§å¤±è´¥');
                    }
                } else {
                    showOtaMessage('æœåŠ¡å™¨å“åº”é”™è¯¯', 'error');
                    updateOtaStatus('ä¸Šä¼ å¤±è´¥');
                }
                
            } catch (error) {
                console.error('OTAå‡çº§å¤±è´¥:', error);
                showOtaMessage('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥è®¾å¤‡è¿æ¥', 'error');
                updateOtaStatus('è¿æ¥å¤±è´¥');
            } finally {
                // é‡ç½®çŠ¶æ€
                setTimeout(() => {
                    resetFileInput();
                    progressContainer.style.display = 'none';
                    updateProgress(0);
                }, 5000);
            }
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(percentage) {
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            
            if (progressFill && progressText) {
                progressFill.style.width = percentage + '%';
                progressText.textContent = percentage + '%';
            }
        }

        // æ˜¾ç¤ºOTAæ¶ˆæ¯
        function showOtaMessage(message, type = '') {
            const messageElement = document.getElementById('ota-message');
            if (messageElement) {
                messageElement.textContent = message;
                messageElement.className = 'ota-message';
                if (type) {
                    messageElement.classList.add(type);
                }
            }
        }

        // æ›´æ–°OTAçŠ¶æ€
        function updateOtaStatus(status) {
            const statusElement = document.getElementById('ota-status');
            if (statusElement) {
                statusElement.textContent = status;
            }
        }

        // æ›´æ–°å›ºä»¶ç‰ˆæœ¬æ˜¾ç¤º
        function updateFirmwareDisplay() {
            const firmwareElement = document.getElementById('current-firmware');
            if (firmwareElement && deviceStatus.firmwareVersion) {
                firmwareElement.textContent = deviceStatus.firmwareVersion;
            }
        }

        // åœ¨çŠ¶æ€æ›´æ–°æ—¶ä¹Ÿæ›´æ–°å›ºä»¶ç‰ˆæœ¬æ˜¾ç¤º
        function updateStatusDisplay(data) {
            deviceStatus = {
                currentTemp: data.temperature || 0,
                targetTemp: data.target_temperature || 180,
                heatingEnabled: data.heating_enabled || false,
                wifiConnected: data.wifi_connected || false,
                wifiSSID: data.wifiSSID || '',
                ipAddress: data.ip_address || '',
                deviceId: data.device_id || '',
                firmwareVersion: data.firmware_version || ''
            };

            // å®‰å…¨åœ°æ›´æ–°æ¸©åº¦æ˜¾ç¤º
            const statusItems = document.querySelectorAll('.status-item');
            if (statusItems.length >= 4) {
                statusItems[0].querySelector('.status-value').textContent = 
                    deviceStatus.currentTemp.toFixed(1) + 'Â°C';
                statusItems[1].querySelector('.status-value').textContent = 
                    deviceStatus.targetTemp.toFixed(1) + 'Â°C';
                
                // æ›´æ–°åŠ çƒ­çŠ¶æ€
                const heatingStatus = deviceStatus.heatingEnabled ? 'åŠ çƒ­ä¸­' : 'å·²åœæ­¢';
                statusItems[2].querySelector('.status-value').textContent = heatingStatus;
                statusItems[2].querySelector('.status-value').style.color = 
                    deviceStatus.heatingEnabled ? '#10b981' : '#6b7280';
                
                // æ›´æ–°WiFiçŠ¶æ€
                const wifiStatus = deviceStatus.wifiConnected ? 'å·²è¿æ¥' : 'æœªè¿æ¥';
                statusItems[3].querySelector('.status-value').textContent = wifiStatus;
                statusItems[3].querySelector('.status-value').style.color = 
                    deviceStatus.wifiConnected ? '#10b981' : '#ef4444';
            }
            
            // æ›´æ–°å›ºä»¶ç‰ˆæœ¬æ˜¾ç¤º
            updateFirmwareDisplay();
            
            // æ›´æ–°æ¸©åº¦æ§åˆ¶é¢æ¿æ˜¾ç¤º
            updateTemperatureControlDisplay();
        }

        // æ›´æ–°æ¸©åº¦æ§åˆ¶é¢æ¿æ˜¾ç¤º
        function updateTemperatureControlDisplay() {
            // æ›´æ–°å½“å‰æ¸©åº¦æ˜¾ç¤º
            const currentTempDisplay = document.getElementById('current-temp-display');
            if (currentTempDisplay) {
                currentTempDisplay.textContent = deviceStatus.currentTemp.toFixed(1) + 'Â°C';
            }
            
            // æ›´æ–°ç›®æ ‡æ¸©åº¦æ˜¾ç¤º
            const targetTempDisplay = document.getElementById('target-temp-display');
            if (targetTempDisplay) {
                targetTempDisplay.textContent = deviceStatus.targetTemp.toFixed(1) + 'Â°C';
            }
            
            // æ›´æ–°åŠ çƒ­æŒ‰é’®çŠ¶æ€
            const heatingBtn = document.getElementById('heating-btn');
            if (heatingBtn) {
                heatingBtn.textContent = deviceStatus.heatingEnabled ? 'å…³é—­åŠ çƒ­' : 'å¼€å¯åŠ çƒ­';
                heatingBtn.className = deviceStatus.heatingEnabled ? 
                    'btn btn-secondary' : 'btn btn-primary';
            }
            
            // æ›´æ–°åŠ çƒ­çŠ¶æ€æŒ‡ç¤ºå™¨
            const heatingStatus = document.getElementById('heating-status');
            if (heatingStatus) {
                if (deviceStatus.heatingEnabled) {
                    heatingStatus.textContent = 'åŠ çƒ­å™¨æ­£åœ¨å·¥ä½œ';
                    heatingStatus.className = 'status-indicator status-heating';
                } else {
                    heatingStatus.textContent = 'åŠ çƒ­å™¨å·²å…³é—­';
                    heatingStatus.className = 'status-indicator status-idle';
                }
            }
        }

        // æ¸©åº¦è°ƒèŠ‚åŠŸèƒ½
        function changeTemp(delta) {
            const newTemp = deviceStatus.targetTemp + delta;
            if (newTemp >= 0 && newTemp <= 300) {
                setTargetTemp(newTemp);
            } else {
                alert('æ¸©åº¦èŒƒå›´å¿…é¡»åœ¨ 0Â°C åˆ° 300Â°C ä¹‹é—´');
            }
        }

        // è®¾ç½®ç›®æ ‡æ¸©åº¦
        async function setTargetTemp(temp) {
            try {
                const response = await fetch('/control', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        target_temperature: temp
                    })
                });
                
                if (response.ok) {
                    refreshData();
                } else {
                    alert('æ¸©åº¦è®¾ç½®å¤±è´¥');
                }
            } catch (error) {
                console.error('è®¾ç½®æ¸©åº¦å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥');
            }
        }

        // é¢„è®¾æ¸©åº¦è®¾ç½®
        function setPresetTemp(temp) {
            setTargetTemp(temp);
        }

        // åº”ç”¨ç›´æ¥è¾“å…¥çš„æ¸©åº¦
        function applyTemperature() {
            const tempInput = document.getElementById('temp-input');
            if (tempInput && tempInput.value) {
                const temp = parseInt(tempInput.value);
                if (temp >= 0 && temp <= 300) {
                    setTargetTemp(temp);
                    tempInput.value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
                } else {
                    alert('è¯·è¾“å…¥ 0Â°C åˆ° 300Â°C ä¹‹é—´çš„æ¸©åº¦å€¼');
                }
            } else {
                alert('è¯·å…ˆè¾“å…¥è¦è®¾ç½®çš„æ¸©åº¦');
            }
        }

        // æ¸©åº¦æ ¡å‡†åŠŸèƒ½
        let currentCalibration = 0.0;

        // åˆ‡æ¢æ ¡å‡†åŠŸèƒ½æ˜¾ç¤º
        function toggleCalibration() {
            const content = document.getElementById('calibration-content');
            const toggleBtn = document.getElementById('calibration-toggle');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                toggleBtn.textContent = 'æ”¶èµ·';
            } else {
                content.style.display = 'none';
                toggleBtn.textContent = 'å±•å¼€';
            }
        }

        // è®¾ç½®æ ¡å‡†å€¼
        function setCalibration(value) {
            const calibrationInput = document.getElementById('calibration-input');
            if (calibrationInput) {
                calibrationInput.value = value;
            }
        }

        // åº”ç”¨æ ¡å‡†
        async function applyCalibration() {
            const calibrationInput = document.getElementById('calibration-input');
            if (!calibrationInput || !calibrationInput.value) {
                alert('è¯·å…ˆè¾“å…¥æ ¡å‡†å€¼');
                return;
            }
            
            const calibrationValue = parseFloat(calibrationInput.value);
            if (isNaN(calibrationValue) || calibrationValue < -10 || calibrationValue > 10) {
                alert('æ ¡å‡†å€¼å¿…é¡»åœ¨ -10Â°C åˆ° 10Â°C ä¹‹é—´');
                return;
            }
            
            try {
                const response = await fetch('/calibration', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        calibration: calibrationValue
                    })
                });
                
                if (response.ok) {
                    currentCalibration = calibrationValue;
                    updateCalibrationDisplay();
                    alert('æ ¡å‡†åº”ç”¨æˆåŠŸï¼');
                } else {
                    alert('æ ¡å‡†è®¾ç½®å¤±è´¥');
                }
            } catch (error) {
                console.error('æ ¡å‡†è®¾ç½®å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥');
            }
        }

        // æ›´æ–°æ ¡å‡†æ˜¾ç¤º
        function updateCalibrationDisplay() {
            const calibrationValue = document.getElementById('current-calibration');
            if (calibrationValue) {
                calibrationValue.textContent = currentCalibration.toFixed(1) + 'Â°C';
            }
        }

        // åœ¨çŠ¶æ€æ›´æ–°æ—¶ä¹Ÿæ›´æ–°æ ¡å‡†æ˜¾ç¤º
        function updateStatusDisplay(data) {
            deviceStatus = {
                currentTemp: data.temperature || 0,
                targetTemp: data.target_temperature || 180,
                heatingEnabled: data.heating_enabled || false,
                wifiConnected: data.wifi_connected || false,
                wifiSSID: data.wifiSSID || '',
                ipAddress: data.ip_address || '',
                deviceId: data.device_id || '',
                firmwareVersion: data.firmware_version || '',
                calibration: data.calibration || 0.0
            };

            // å®‰å…¨åœ°æ›´æ–°æ¸©åº¦æ˜¾ç¤º
            const statusItems = document.querySelectorAll('.status-item');
            if (statusItems.length >= 4) {
                statusItems[0].querySelector('.status-value').textContent = 
                    deviceStatus.currentTemp.toFixed(1) + 'Â°C';
                statusItems[1].querySelector('.status-value').textContent = 
                    deviceStatus.targetTemp.toFixed(1) + 'Â°C';
                
                // æ›´æ–°åŠ çƒ­çŠ¶æ€
                const heatingStatus = deviceStatus.heatingEnabled ? 'åŠ çƒ­ä¸­' : 'å·²åœæ­¢';
                statusItems[2].querySelector('.status-value').textContent = heatingStatus;
                statusItems[2].querySelector('.status-value').style.color = 
                    deviceStatus.heatingEnabled ? '#10b981' : '#6b7280';
                
                // æ›´æ–°WiFiçŠ¶æ€
                const wifiStatus = deviceStatus.wifiConnected ? 'å·²è¿æ¥' : 'æœªè¿æ¥';
                statusItems[3].querySelector('.status-value').textContent = wifiStatus;
                statusItems[3].querySelector('.status-value').style.color = 
                    deviceStatus.wifiConnected ? '#10b981' : '#ef4444';
            }
            
            // æ›´æ–°å›ºä»¶ç‰ˆæœ¬æ˜¾ç¤º
            updateFirmwareDisplay();
            
            // æ›´æ–°æ¸©åº¦æ§åˆ¶é¢æ¿æ˜¾ç¤º
            updateTemperatureControlDisplay();
            
            // æ›´æ–°æ ¡å‡†æ˜¾ç¤º
            currentCalibration = deviceStatus.calibration;
            updateCalibrationDisplay();
        }

        // ç³»ç»Ÿç®¡ç†åŠŸèƒ½å‡½æ•°
        
        // æ‰“å¼€WiFié…ç½®é¡µé¢
        function openWifiConfig() {
            window.open('wifi_config.html', '_blank');
        }
        
        // é‡å¯è®¾å¤‡
        async function restartDevice() {
            const confirmed = confirm('ç¡®å®šè¦é‡å¯è®¾å¤‡å—ï¼Ÿé‡å¯è¿‡ç¨‹å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚');
            if (!confirmed) return;
            
            try {
                const response = await fetch('/restart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                if (response.ok) {
                    alert('è®¾å¤‡é‡å¯å‘½ä»¤å·²å‘é€ï¼Œè®¾å¤‡å°†åœ¨å‡ ç§’é’Ÿåé‡å¯ã€‚');
                    // æ˜¾ç¤ºé‡å¯æç¤º
                    showRestartMessage();
                } else {
                    alert('é‡å¯å‘½ä»¤å‘é€å¤±è´¥');
                }
            } catch (error) {
                console.error('é‡å¯è®¾å¤‡å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œæ— æ³•é‡å¯è®¾å¤‡');
            }
        }
        
        // æ˜¾ç¤ºé‡å¯æç¤º
        function showRestartMessage() {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                z-index: 1000;
                font-size: 16px;
                max-width: 300px;
            `;
            messageDiv.innerHTML = `
                <div style="font-size: 24px; margin-bottom: 15px;">ğŸ”„</div>
                <div style="font-weight: 600; margin-bottom: 10px;">è®¾å¤‡æ­£åœ¨é‡å¯</div>
                <div style="font-size: 14px; opacity: 0.8;">
                    è®¾å¤‡æ­£åœ¨é‡å¯ï¼Œè¯·ç­‰å¾…å‡ åˆ†é’Ÿåé‡æ–°è¿æ¥ã€‚
                </div>
            `;
            document.body.appendChild(messageDiv);
            
            // 5ç§’åè‡ªåŠ¨åˆ·æ–°é¡µé¢
            setTimeout(() => {
                window.location.reload();
            }, 5000);
        }
        
        // æ¢å¤å‡ºå‚è®¾ç½®
        async function factoryReset() {
            const confirmed = confirm('âš ï¸ è­¦å‘Šï¼šæ­¤æ“ä½œå°†æ¸…é™¤æ‰€æœ‰è®¾ç½®å¹¶æ¢å¤è®¾å¤‡åˆ°å‡ºå‚çŠ¶æ€ï¼\n\nç¡®å®šè¦ç»§ç»­å—ï¼Ÿ');
            if (!confirmed) return;
            
            const password = prompt('è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ç¡®è®¤æ“ä½œï¼š');
            if (!password) return;
            
            try {
                const response = await fetch('/factoryreset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        password: password
                    })
                });
                
                if (response.ok) {
                    alert('è®¾å¤‡å·²æ¢å¤å‡ºå‚è®¾ç½®ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é‡å¯ã€‚');
                    // æ˜¾ç¤ºæ¢å¤å‡ºå‚è®¾ç½®æç¤º
                    showFactoryResetMessage();
                } else {
                    alert('æ¢å¤å‡ºå‚è®¾ç½®å¤±è´¥ï¼Œå¯†ç å¯èƒ½ä¸æ­£ç¡®');
                }
            } catch (error) {
                console.error('æ¢å¤å‡ºå‚è®¾ç½®å¤±è´¥:', error);
                alert('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œæ— æ³•æ¢å¤å‡ºå‚è®¾ç½®');
            }
        }
        
        // æ˜¾ç¤ºæ¢å¤å‡ºå‚è®¾ç½®æç¤º
        function showFactoryResetMessage() {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                z-index: 1000;
                font-size: 16px;
                max-width: 300px;
            `;
            messageDiv.innerHTML = `
                <div style="font-size: 24px; margin-bottom: 15px;">âš ï¸</div>
                <div style="font-weight: 600; margin-bottom: 10px;">è®¾å¤‡æ­£åœ¨æ¢å¤å‡ºå‚è®¾ç½®</div>
                <div style="font-size: 14px; opacity: 0.8;">
                    æ‰€æœ‰è®¾ç½®å°†è¢«æ¸…é™¤ï¼Œè®¾å¤‡å°†é‡å¯å¹¶æ¢å¤å‡ºå‚çŠ¶æ€ã€‚
                </div>
            `;
            document.body.appendChild(messageDiv);
            
            // 5ç§’åè‡ªåŠ¨åˆ·æ–°é¡µé¢
            setTimeout(() => {
                window.location.reload();
            }, 5000);
        }

    </script>
</body>
</html>