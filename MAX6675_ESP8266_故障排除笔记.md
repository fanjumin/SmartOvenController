# MAX6675å¨ESP8266ä¸çæéæé¤ç¬è®°

## ð é®é¢æè¿°
SmartOvenControllerç¨åºæ æ³è¯»åMAX6675æ¸©åº¦ä¼ æå¨æ°æ®ï¼æ¸©åº¦å§ç»æ¾ç¤º0.00Â°Cã

## ð æ ¹æ¬åå 
- **åºå¼å®¹æ§é®é¢**ï¼æ åç`MAX6675.h`åºæ¯ä¸ºArduinoè®¾è®¡çï¼å¨ESP8266ä¸å­å¨å¼å®¹æ§é®é¢
- **SPIéä¿¡å¤±è´¥**ï¼åºå½æ°æ æ³æ­£ç¡®ä¸MAX6675è¿è¡SPIéä¿¡

## â å·²éªè¯çè§£å³æ¹æ¡

### æ¹æ¡1ï¼æå¨SPIä½æä½ï¼æ¨èï¼

#### å¼èéç½®ï¼ESP8266 NodeMCUï¼
```cpp
#define THERMO_CLK 14  // D5 (GPIO14)
#define THERMO_CS  12  // D6 (GPIO12)  
#define THERMO_DO  13  // D7 (GPIO13)
```

#### æå¨è¯»åå½æ°
```cpp
uint16_t readMAX6675RawData() {
  uint16_t data = 0;
  
  // å¯ç¨è¯ç
  digitalWrite(THERMO_CS, LOW);
  delayMicroseconds(1);
  
  // è¯»å16ä½æ°æ®ï¼MSBä¼åï¼
  for (int i = 15; i >= 0; i--) {
    digitalWrite(THERMO_CLK, HIGH);  // æ¶éä¸åæ²¿
    delayMicroseconds(1);
    
    if (digitalRead(THERMO_DO)) {   // è¯»åæ°æ®ä½
      data |= (1 << i);
    }
    
    digitalWrite(THERMO_CLK, LOW);  // æ¶éä¸éæ²¿
    delayMicroseconds(1);
  }
  
  // ç¦ç¨è¯ç
  digitalWrite(THERMO_CS, HIGH);
  
  return data;
}
```

#### æ°æ®è§£æ
```cpp
// åæåå§æ°æ®
uint16_t rawData = readMAX6675RawData();

// æ£æ¥éè¯¯æ å¿ä½
if (!(rawData & 0x04)) {  // D2ä½ä¸º0è¡¨ç¤ºæ­£å¸¸
  uint16_t tempBits = rawData >> 3;  // å³ç§»3ä½è·åæ¸©åº¦æ°æ®
  float temperature = tempBits * 0.25;  // æ¯ä¸ªåä½0.25Â°C
}
```

### æ¹æ¡2ï¼ä½¿ç¨ESP8266ç¡¬ä»¶SPIï¼å¤éï¼
```cpp
// ç¡¬ä»¶SPIå¼èå®ä¹
#define HSPI_MISO 12  // GPIO12 (D6)
#define HSPI_MOSI 13  // GPIO13 (D7)  
#define HSPI_SCK  14  // GPIO14 (D5)
#define HSPI_SS   15  // GPIO15 (D8)
```

## ð æ°æ®æ ¼å¼è¯´æ

### MAX6675 SPIæ°æ®æ ¼å¼ï¼16ä½ï¼
```
D15 D14 D13 D12 D11 D10 D9 D8 D7 D6 D5 D4 D3 D2 D1 D0
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  |  |
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  |  +-- D0: ä¿çä½
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  +----- D1: ä¿çä½
 |   |   |   |   |   |   |  |  |  |  |  |  |  +-------- D2: éè¯¯æ å¿ä½ (0=æ­£å¸¸, 1=éè¯¯)
 |   |   |   |   |   |   |  |  |  |  |  |  +----------- D3: ä¿çä½
 |   |   |   |   |   |   |  |  |  |  |  +-------------- D4-D14: 12ä½æ¸©åº¦æ°æ®
 |   |   |   |   |   |   |  |  |  |  +----------------- D15: è®¾å¤IDä½ (åºä¸º0)
```

### æ¸©åº¦è®¡ç®
- **æ¸©åº¦èå´**ï¼-50Â°C å° 400Â°C
- **åè¾¨ç**ï¼0.25Â°C/ä½
- **è®¡ç®å¬å¼**ï¼`æ¸©åº¦ = (åå§æ°æ® >> 3) Ã 0.25`

## ð§ æéæé¤æ­¥éª¤

### 1. æ£æ¥ç¡¬ä»¶è¿æ¥
- ç¡®è®¤MAX6675å¼èæ­£ç¡®è¿æ¥å°ESP8266
- æ£æ¥çµæºçµåï¼3.3Væ5Vï¼
- éªè¯æ¥å°è¿æ¥

### 2. æµè¯SPIéä¿¡
```cpp
// ç®åçSPIéä¿¡æµè¯
void testSPICommunication() {
  Serial.println("ð å¼å§SPIéä¿¡æµè¯...");
  
  uint16_t rawData = readMAX6675RawData();
  Serial.print("ð åå§æ°æ®: 0x"); Serial.println(rawData, HEX);
  
  // æ£æ¥æ°æ®æææ§
  if (rawData == 0x0000 || rawData == 0xFFFF) {
    Serial.println("â æ°æ®å¼å¸¸ï¼å¨0æå¨1ï¼æ£æ¥ç¡¬ä»¶è¿æ¥");
  } else if (rawData & 0x04) {
    Serial.println("â SPIéä¿¡éè¯¯ï¼æ£æ¥å¼èåæ¶åº");
  } else {
    Serial.println("â SPIéä¿¡æ­£å¸¸");
  }
}
```

### 3. éªè¯æ¸©åº¦è¯»æ°
```cpp
void verifyTemperature() {
  float temp = readTemperature();
  
  if (temp >= -50.0 && temp <= 400.0) {
    Serial.print("â æ¸©åº¦æ­£å¸¸: "); Serial.print(temp); Serial.println("Â°C");
  } else {
    Serial.println("â æ¸©åº¦è¯»æ°è¶åºèå´");
  }
}
```

## ð¨ å¸¸è§éè¯¯åè§£å³æ¹æ¡

### éè¯¯1ï¼æ¸©åº¦å§ç»ä¸º0.00Â°C
- **åå **ï¼MAX6675.håºä¸å¼å®¹ESP8266
- **è§£å³æ¹æ¡**ï¼ä½¿ç¨æå¨SPIä½æä½æ¹æ³

### éè¯¯2ï¼SPIéä¿¡éè¯¯ï¼D2ä½ä¸º1ï¼
- **åå **ï¼å¼èè¿æ¥éè¯¯ææ¶åºé®é¢
- **è§£å³æ¹æ¡**ï¼æ£æ¥å¼èå®ä¹åå»¶è¿æ¶é´

### éè¯¯3ï¼æ°æ®å¨ä¸º0æå¨ä¸º1
- **åå **ï¼ç¡¬ä»¶è¿æ¥é®é¢æè¯çæªåå§å
- **è§£å³æ¹æ¡**ï¼æ£æ¥çµæºãæ¥å°åCSå¼è

### éè¯¯4ï¼ç­çµå¶å¼è·¯éè¯¯ï¼æ¸©åº¦æ¾ç¤ºnanÂ°Cæ0.00Â°Cï¼
- **åå **ï¼ç­çµå¶æªè¿æ¥ãè¿æ¥æ¾å¨ææå
- **è§£å³æ¹æ¡**ï¼
  1. **æ£æ¥ç­çµå¶è¿æ¥**ï¼ç¡®è®¤ç­çµå¶æ­£ç¡®æå¥MAX6675æ¨¡åçKåæ¥å£
  2. **æ£æ¥ç­çµå¶ç¶æ**ï¼ç¨ä¸ç¨è¡¨æµéç­çµå¶çµé»ï¼æ­£å¸¸åºä¸ºå æ¬§å§ï¼
  3. **æ£æ¥MAX6675æ¨¡å**ï¼ç¡®è®¤æ¨¡åVCCåGNDè¿æ¥æ­£ç¡®
  4. **æ´æ¢ç­çµå¶æµè¯**ï¼ä½¿ç¨å¤ç¨ç­çµå¶éªè¯é®é¢
- **è¯æ­ä»£ç **ï¼
```cpp
// æ£æ¥ç­çµå¶å¼è·¯éè¯¯
uint16_t rawData = readMAX6675RawData();
if (rawData & 0x04) {
  Serial.println("â ç­çµå¶å¼è·¯éè¯¯ - æ£æ¥ç­çµå¶è¿æ¥");
}
```

## ð ç¸å³æä»¶
- `MAX6675_Test/MAX6675_Test.ino` - å®æ´çæµè¯ç¨åº
- `SmartOvenController.ino` - ä¸»ç¨åºï¼éè¦éææå¨SPIæ¹æ³ï¼

## ð¡ æä½³å®è·µ
1. **ä¼åä½¿ç¨æå¨SPI**ï¼å¨ESP8266ä¸æ¯åºå½æ°æ´å¯é 
2. **æ·»å éè¯¯æ£æ¥**ï¼å§ç»æ£æ¥D2éè¯¯æ å¿ä½
3. **åçå»¶è¿**ï¼SPIéä¿¡éè¦éå½çå¾®ç§çº§å»¶è¿
4. **æ¸©åº¦èå´éªè¯**ï¼ç¡®ä¿è¯»æ°å¨-50Â°Cå°400Â°Cèå´å

## ð ç´§æ¥æ¢å¤
å¦æåæ¬¡åºç°æ¸©åº¦è¯»åé®é¢ï¼ç´æ¥ä½¿ç¨`MAX6675_Test`æä»¶å¤¹ä¸­çæµè¯ç¨åºè¿è¡è¯æ­ã

---
*æåæ´æ°ï¼2024å¹´*  
*åå»ºèï¼AIå©æ*  
*éç¨äºï¼SmartOvenControlleré¡¹ç®*