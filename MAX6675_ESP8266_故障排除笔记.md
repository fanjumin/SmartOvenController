# MAX6675åœ¨ESP8266ä¸Šçš„æ•…éšœæ’é™¤ç¬”è®°

## ğŸ“‹ é—®é¢˜æè¿°
SmartOvenControllerç¨‹åºæ— æ³•è¯»å–MAX6675æ¸©åº¦ä¼ æ„Ÿå™¨æ•°æ®ï¼Œæ¸©åº¦å§‹ç»ˆæ˜¾ç¤º0.00Â°Cã€‚

## ğŸ” æ ¹æœ¬åŸå› 
- **åº“å…¼å®¹æ€§é—®é¢˜**ï¼šæ ‡å‡†çš„`MAX6675.h`åº“æ˜¯ä¸ºArduinoè®¾è®¡çš„ï¼Œåœ¨ESP8266ä¸Šå­˜åœ¨å…¼å®¹æ€§é—®é¢˜
- **SPIé€šä¿¡å¤±è´¥**ï¼šåº“å‡½æ•°æ— æ³•æ­£ç¡®ä¸MAX6675è¿›è¡ŒSPIé€šä¿¡

## âœ… å·²éªŒè¯çš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨SPIä½æ“ä½œï¼ˆæ¨èï¼‰

#### å¼•è„šé…ç½®ï¼ˆESP8266 NodeMCUï¼‰
```cpp
#define THERMO_CLK 14  // D5 (GPIO14)
#define THERMO_CS  12  // D6 (GPIO12)  
#define THERMO_DO  13  // D7 (GPIO13)
```

#### æ‰‹åŠ¨è¯»å–å‡½æ•°
```cpp
uint16_t readMAX6675RawData() {
  uint16_t data = 0;
  
  // å¯ç”¨èŠ¯ç‰‡
  digitalWrite(THERMO_CS, LOW);
  delayMicroseconds(1);
  
  // è¯»å–16ä½æ•°æ®ï¼ˆMSBä¼˜å…ˆï¼‰
  for (int i = 15; i >= 0; i--) {
    digitalWrite(THERMO_CLK, HIGH);  // æ—¶é’Ÿä¸Šå‡æ²¿
    delayMicroseconds(1);
    
    if (digitalRead(THERMO_DO)) {   // è¯»å–æ•°æ®ä½
      data |= (1 << i);
    }
    
    digitalWrite(THERMO_CLK, LOW);  // æ—¶é’Ÿä¸‹é™æ²¿
    delayMicroseconds(1);
  }
  
  // ç¦ç”¨èŠ¯ç‰‡
  digitalWrite(THERMO_CS, HIGH);
  
  return data;
}
```

#### æ•°æ®è§£æ
```cpp
// åˆ†æåŸå§‹æ•°æ®
uint16_t rawData = readMAX6675RawData();

// æ£€æŸ¥é”™è¯¯æ ‡å¿—ä½
if (!(rawData & 0x04)) {  // D2ä½ä¸º0è¡¨ç¤ºæ­£å¸¸
  uint16_t tempBits = rawData >> 3;  // å³ç§»3ä½è·å–æ¸©åº¦æ•°æ®
  float temperature = tempBits * 0.25;  // æ¯ä¸ªå•ä½0.25Â°C
}
```

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ESP8266ç¡¬ä»¶SPIï¼ˆå¤‡é€‰ï¼‰
```cpp
// ç¡¬ä»¶SPIå¼•è„šå®šä¹‰
#define HSPI_MISO 12  // GPIO12 (D6)
#define HSPI_MOSI 13  // GPIO13 (D7)  
#define HSPI_SCK  14  // GPIO14 (D5)
#define HSPI_SS   15  // GPIO15 (D8)
```

## ğŸ“Š æ•°æ®æ ¼å¼è¯´æ˜

### MAX6675 SPIæ•°æ®æ ¼å¼ï¼ˆ16ä½ï¼‰
```
D15 D14 D13 D12 D11 D10 D9 D8 D7 D6 D5 D4 D3 D2 D1 D0
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  |  |
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  |  +-- D0: ä¿ç•™ä½
 |   |   |   |   |   |   |  |  |  |  |  |  |  |  +----- D1: ä¿ç•™ä½
 |   |   |   |   |   |   |  |  |  |  |  |  |  +-------- D2: é”™è¯¯æ ‡å¿—ä½ (0=æ­£å¸¸, 1=é”™è¯¯)
 |   |   |   |   |   |   |  |  |  |  |  |  +----------- D3: ä¿ç•™ä½
 |   |   |   |   |   |   |  |  |  |  |  +-------------- D4-D14: 12ä½æ¸©åº¦æ•°æ®
 |   |   |   |   |   |   |  |  |  |  +----------------- D15: è®¾å¤‡IDä½ (åº”ä¸º0)
```

### æ¸©åº¦è®¡ç®—
- **æ¸©åº¦èŒƒå›´**ï¼š-50Â°C åˆ° 400Â°C
- **åˆ†è¾¨ç‡**ï¼š0.25Â°C/ä½
- **è®¡ç®—å…¬å¼**ï¼š`æ¸©åº¦ = (åŸå§‹æ•°æ® >> 3) Ã— 0.25`

## ğŸ”§ æ•…éšœæ’é™¤æ­¥éª¤

### 1. æ£€æŸ¥ç¡¬ä»¶è¿æ¥
- ç¡®è®¤MAX6675å¼•è„šæ­£ç¡®è¿æ¥åˆ°ESP8266
- æ£€æŸ¥ç”µæºç”µå‹ï¼ˆ3.3Væˆ–5Vï¼‰
- éªŒè¯æ¥åœ°è¿æ¥

### 2. æµ‹è¯•SPIé€šä¿¡
```cpp
// ç®€å•çš„SPIé€šä¿¡æµ‹è¯•
void testSPICommunication() {
  Serial.println("ğŸ” å¼€å§‹SPIé€šä¿¡æµ‹è¯•...");
  
  uint16_t rawData = readMAX6675RawData();
  Serial.print("ğŸ“Š åŸå§‹æ•°æ®: 0x"); Serial.println(rawData, HEX);
  
  // æ£€æŸ¥æ•°æ®æœ‰æ•ˆæ€§
  if (rawData == 0x0000 || rawData == 0xFFFF) {
    Serial.println("âŒ æ•°æ®å¼‚å¸¸ï¼šå…¨0æˆ–å…¨1ï¼Œæ£€æŸ¥ç¡¬ä»¶è¿æ¥");
  } else if (rawData & 0x04) {
    Serial.println("âŒ SPIé€šä¿¡é”™è¯¯ï¼Œæ£€æŸ¥å¼•è„šå’Œæ—¶åº");
  } else {
    Serial.println("âœ… SPIé€šä¿¡æ­£å¸¸");
  }
}
```

### 3. éªŒè¯æ¸©åº¦è¯»æ•°
```cpp
void verifyTemperature() {
  float temp = readTemperature();
  
  if (temp >= -50.0 && temp <= 400.0) {
    Serial.print("âœ… æ¸©åº¦æ­£å¸¸: "); Serial.print(temp); Serial.println("Â°C");
  } else {
    Serial.println("âŒ æ¸©åº¦è¯»æ•°è¶…å‡ºèŒƒå›´");
  }
}
```

## ğŸš¨ å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

### é”™è¯¯1ï¼šæ¸©åº¦å§‹ç»ˆä¸º0.00Â°C
- **åŸå› **ï¼šMAX6675.håº“ä¸å…¼å®¹ESP8266
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æ‰‹åŠ¨SPIä½æ“ä½œæ–¹æ³•

### é”™è¯¯2ï¼šSPIé€šä¿¡é”™è¯¯ï¼ˆD2ä½ä¸º1ï¼‰
- **åŸå› **ï¼šå¼•è„šè¿æ¥é”™è¯¯æˆ–æ—¶åºé—®é¢˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥å¼•è„šå®šä¹‰å’Œå»¶è¿Ÿæ—¶é—´

### é”™è¯¯3ï¼šæ•°æ®å…¨ä¸º0æˆ–å…¨ä¸º1
- **åŸå› **ï¼šç¡¬ä»¶è¿æ¥é—®é¢˜æˆ–èŠ¯ç‰‡æœªåˆå§‹åŒ–
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ç”µæºã€æ¥åœ°å’ŒCSå¼•è„š

### é”™è¯¯4ï¼šçƒ­ç”µå¶å¼€è·¯é”™è¯¯ï¼ˆæ¸©åº¦æ˜¾ç¤ºnanÂ°Cæˆ–0.00Â°Cï¼‰
- **åŸå› **ï¼šçƒ­ç”µå¶æœªè¿æ¥ã€è¿æ¥æ¾åŠ¨æˆ–æŸå
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  1. **æ£€æŸ¥çƒ­ç”µå¶è¿æ¥**ï¼šç¡®è®¤çƒ­ç”µå¶æ­£ç¡®æ’å…¥MAX6675æ¨¡å—çš„Kå‹æ¥å£
  2. **æ£€æŸ¥çƒ­ç”µå¶çŠ¶æ€**ï¼šç”¨ä¸‡ç”¨è¡¨æµ‹é‡çƒ­ç”µå¶ç”µé˜»ï¼ˆæ­£å¸¸åº”ä¸ºå‡ æ¬§å§†ï¼‰
  3. **æ£€æŸ¥MAX6675æ¨¡å—**ï¼šç¡®è®¤æ¨¡å—VCCå’ŒGNDè¿æ¥æ­£ç¡®
  4. **æ›´æ¢çƒ­ç”µå¶æµ‹è¯•**ï¼šä½¿ç”¨å¤‡ç”¨çƒ­ç”µå¶éªŒè¯é—®é¢˜
- **è¯Šæ–­ä»£ç **ï¼š
```cpp
// æ£€æŸ¥çƒ­ç”µå¶å¼€è·¯é”™è¯¯
uint16_t rawData = readMAX6675RawData();
if (rawData & 0x04) {
  Serial.println("âŒ çƒ­ç”µå¶å¼€è·¯é”™è¯¯ - æ£€æŸ¥çƒ­ç”µå¶è¿æ¥");
}
```

## ğŸ“ ç›¸å…³æ–‡ä»¶
- `MAX6675_Test/MAX6675_Test.ino` - å®Œæ•´çš„æµ‹è¯•ç¨‹åº
- `SmartOvenController.ino` - ä¸»ç¨‹åºï¼ˆéœ€è¦é›†æˆæ‰‹åŠ¨SPIæ–¹æ³•ï¼‰

## ğŸ’¡ æœ€ä½³å®è·µ
1. **ä¼˜å…ˆä½¿ç”¨æ‰‹åŠ¨SPI**ï¼šåœ¨ESP8266ä¸Šæ¯”åº“å‡½æ•°æ›´å¯é 
2. **æ·»åŠ é”™è¯¯æ£€æŸ¥**ï¼šå§‹ç»ˆæ£€æŸ¥D2é”™è¯¯æ ‡å¿—ä½
3. **åˆç†å»¶è¿Ÿ**ï¼šSPIé€šä¿¡éœ€è¦é€‚å½“çš„å¾®ç§’çº§å»¶è¿Ÿ
4. **æ¸©åº¦èŒƒå›´éªŒè¯**ï¼šç¡®ä¿è¯»æ•°åœ¨-50Â°Cåˆ°400Â°CèŒƒå›´å†…

## ğŸ“ ç´§æ€¥æ¢å¤
å¦‚æœå†æ¬¡å‡ºç°æ¸©åº¦è¯»å–é—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨`MAX6675_Test`æ–‡ä»¶å¤¹ä¸­çš„æµ‹è¯•ç¨‹åºè¿›è¡Œè¯Šæ–­ã€‚

---
*æœ€åæ›´æ–°ï¼š2024å¹´*  
*åˆ›å»ºè€…ï¼šAIåŠ©æ‰‹*  
*é€‚ç”¨äºï¼šSmartOvenControlleré¡¹ç›®*