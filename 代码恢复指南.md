# 代码恢复指南

## 快速恢复方法

### 1. 恢复到最新稳定版本（v0.4.0）
```bash
# 恢复到v0.4.0标签版本
git checkout v0.4.0

# 或者使用更安全的方式（创建新分支）
git checkout -b recovery-v0.4.0 v0.4.0
```

### 2. 恢复到上一个提交
```bash
# 恢复到上一个提交
git reset --hard HEAD~

# 或者恢复到特定提交
git reset --hard <commit-hash>
```

### 3. 丢弃所有未提交的更改
```bash
# 丢弃所有未提交的更改
git reset --hard HEAD

# 或者逐个文件恢复
git restore <file-name>
```

## 版本标签说明

| 版本标签 | 说明 | 恢复命令 |
|---------|------|----------|
| v0.4.0 | 当前稳定版本 | `git checkout v0.4.0` |
| v0.3.1 | 上一个稳定版本 | `git checkout v0.3.1` |

## 备份策略

### 1. 重要修改前创建备份分支
```bash
# 创建备份分支
git checkout -b backup-<日期>-<功能描述>

# 提交当前状态
git add .
git commit -m "备份: <功能描述>"
```

### 2. 定期创建里程碑标签
```bash
# 创建里程碑标签
git tag -a milestone-<日期> -m "里程碑: <描述>"
```

## 紧急恢复流程

### 情况1：代码编译失败
1. 检查当前状态：`git status`
2. 如果只是本地修改导致编译失败：`git restore .`
3. 重新编译：`cd SmartOvenApp && .\gradlew assembleDebug`

### 情况2：功能测试失败
1. 恢复到上一个稳定版本：`git checkout v0.4.0`
2. 重新编译并测试
3. 如果问题依旧，检查设备端代码

### 情况3：设备连接问题
1. 检查网络连接和设备IP
2. 运行测试脚本：`python test_device_response.py`
3. 如果设备无响应，检查设备固件

## 预防措施

### 1. 提交前检查
- 运行编译检查：`cd SmartOvenApp && .\gradlew assembleDebug`
- 运行基本测试：`python test_device_response.py`
- 确保所有功能正常

### 2. 小步提交
- 每次只修改一个功能
- 及时提交并添加描述性注释
- 避免大范围修改

### 3. 分支管理
- 新功能开发使用特性分支
- 主分支保持稳定
- 定期合并和测试

## 常用Git命令参考

```bash
# 查看提交历史
git log --oneline

# 查看文件更改
git diff

# 查看特定文件的更改历史
git log -p <file-name>

# 创建新分支
git checkout -b feature/<功能名>

# 合并分支
git merge <分支名>

# 删除分支
git branch -d <分支名>
```

## 联系支持

如果遇到无法解决的问题，可以：
1. 查看VERSION.md文件了解版本历史
2. 检查backup_v0.3.1目录中的备份文件
3. 运行相应的测试脚本验证功能

记住：**小步提交，频繁测试，及时备份**是避免代码损坏的最佳实践。